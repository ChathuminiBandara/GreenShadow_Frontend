<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monitoring Logs - Crop Monitoring System</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
<header class="bg-success text-white p-3">
    <h1 class="text-center">Logs Managing Point</h1>
</header>

<main class="container mt-4">
    <section id="logs">
        <h2>Monitoring Logs</h2>
        <p>This section contains all monitoring logs related to crop management activities. Users can track and analyze data to improve crop yield and management efficiency.</p>

        <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addLogModal">Add New Log Entry</button>

        <!-- Logs Table -->
        <table class="table table-striped" id="logsTable">
            <thead>
            <tr>
                <th scope="col">Log ID</th>
                <th scope="col">Date</th>
                <th scope="col">Activity</th>
                <th scope="col">User</th>
                <th scope="col">Details</th>
                <th scope="col">Actions</th>
            </tr>
            </thead>
            <tbody>
            <!-- Log Entries will be inserted dynamically here -->
            </tbody>
        </table>

        <h4>Log Management Actions</h4>
        <p>Users can perform the following actions related to log management:</p>
        <ul>
            <li><strong>Add New Log Entry:</strong> Enter details to add a new activity log.</li>
            <li><strong>Edit Existing Log:</strong> Modify details of existing log entries for accuracy.</li>
            <li><strong>Delete Log Entry:</strong> Remove logs that are no longer relevant.</li>
        </ul>

        <h4>Analysis and Reporting</h4>
        <p>Logs are essential for analyzing the effectiveness of crop management practices. Regular reviews can lead to insights such as:</p>
        <ul>
            <li>Identifying successful pest control methods</li>
            <li>Evaluating the impact of irrigation schedules on crop yield</li>
            <li>Tracking the frequency of equipment usage</li>
        </ul>

        <p>For further assistance or support regarding monitoring logs, please contact the management team.</p>
    </section>
</main>

<!-- Add Log Modal -->
<div class="modal fade" id="addLogModal" tabindex="-1" aria-labelledby="addLogModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addLogModalLabel">Add New Log Entry</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="addLogForm">
                    <div class="mb-3">
                        <label for="logDate" class="form-label">Date</label>
                        <input type="date" class="form-control" id="logDate" required>
                    </div>
                    <div class="mb-3">
                        <label for="logActivity" class="form-label">Activity</label>
                        <input type="text" class="form-control" id="logActivity" required>
                    </div>
                    <div class="mb-3">
                        <label for="logUser" class="form-label">User</label>
                        <input type="text" class="form-control" id="logUser" required>
                    </div>
                    <div class="mb-3">
                        <label for="logDetails" class="form-label">Details</label>
                        <textarea class="form-control" id="logDetails" rows="3" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Add Log</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Edit Log Modal -->
<div class="modal fade" id="editLogModal" tabindex="-1" aria-labelledby="editLogModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editLogModalLabel">Edit Log Entry</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="editLogForm">
                    <input type="hidden" id="editLogId">
                    <div class="mb-3">
                        <label for="editLogDate" class="form-label">Date</label>
                        <input type="date" class="form-control" id="editLogDate" required>
                    </div>
                    <div class="mb-3">
                        <label for="editLogActivity" class="form-label">Activity</label>
                        <input type="text" class="form-control" id="editLogActivity" required>
                    </div>
                    <div class="mb-3">
                        <label for="editLogUser" class="form-label">User</label>
                        <input type="text" class="form-control" id="editLogUser" required>
                    </div>
                    <div class="mb-3">
                        <label for="editLogDetails" class="form-label">Details</label>
                        <textarea class="form-control" id="editLogDetails" rows="3" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteLogModal" tabindex="-1" aria-labelledby="deleteLogModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteLogModalLabel">Delete Log Entry</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this log entry?</p>
                <button type="button" class="btn btn-danger" id="deleteLogButton">Delete</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
<script>
    // Global log counter to generate unique log IDs
    let logIdCounter = 1;
    const logsTableBody = $('#logsTable tbody');
    const logs = [];

    // Function to render logs to the table
    function renderLogs() {
        logsTableBody.empty();
        logs.forEach((log, index) => {
            logsTableBody.append(`
                <tr data-index="${index}">
                    <td>${log.id}</td>
                    <td>${log.date}</td>
                    <td>${log.activity}</td>
                    <td>${log.user}</td>
                    <td>${log.details}</td>
                    <td>
                        <button class="btn btn-warning btn-sm editLogButton" data-index="${index}" data-bs-toggle="modal" data-bs-target="#editLogModal">Edit</button>
                        <button class="btn btn-danger btn-sm deleteLogButton" data-index="${index}" data-bs-toggle="modal" data-bs-target="#deleteLogModal">Delete</button>
                    </td>
                </tr>
            `);
        });
    }

    // Add Log Form Submission
    $('#addLogForm').submit(function (e) {
        e.preventDefault();

        const newLog = {
            id: `L${logIdCounter++}`,  // Generate a new unique ID
            date: $('#logDate').val(),
            activity: $('#logActivity').val(),
            user: $('#logUser').val(),
            details: $('#logDetails').val()
        };

        logs.push(newLog);
        renderLogs();
        $('#addLogModal').modal('hide');
    });

    // Edit Log Button Click
    $(document).on('click', '.editLogButton', function () {
        const index = $(this).data('index');
        const log = logs[index];
        $('#editLogId').val(log.id);
        $('#editLogDate').val(log.date);
        $('#editLogActivity').val(log.activity);
        $('#editLogUser').val(log.user);
        $('#editLogDetails').val(log.details);
    });

    // Edit Log Form Submission
    $('#editLogForm').submit(function (e) {
        e.preventDefault();
        const index = logs.findIndex(log => log.id === $('#editLogId').val());
        if (index !== -1) {
            logs[index].date = $('#editLogDate').val();
            logs[index].activity = $('#editLogActivity').val();
            logs[index].user = $('#editLogUser').val();
            logs[index].details = $('#editLogDetails').val();
            renderLogs();
            $('#editLogModal').modal('hide');
        }
    });

    // Delete Log Button Click
    $(document).on('click', '.deleteLogButton', function () {
        const index = $(this).data('index');
        $('#deleteLogButton').data('index', index);
    });

    // Confirm Delete
    $('#deleteLogButton').click(function () {
        const index = $(this).data('index');
        logs.splice(index, 1);
        renderLogs();
        $('#deleteLogModal').modal('hide');
    });

    // Initial Rendering of Logs
    renderLogs();
</script>

</body>
</html>
